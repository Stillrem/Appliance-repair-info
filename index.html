<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>Appliance Repair Pro</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#34c759" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Repair Pro" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png" />
    <style>
        /* ...–í–°–ï –í–ê–®–ò CSS –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô... */
        :root { --primary: #34c759; /* ...–∏ –¥–∞–ª–µ–µ –∫–∞–∫ –±—ã–ª–æ –≤—ã—à–µ... */ }
        /* —Å—é–¥–∞ ‚Äî –≤—Å—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∞—à–µ–≥–æ <style> –±–ª–æ–∫–∞ */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üîß</div>
            <h1 class="title">Appliance Repair Pro</h1>
            <p class="subtitle">Professional Service Reports</p>

            <div class="mode-toggle">
                <button class="mode-btn active" data-mode="technician">üë®‚Äçüîß Technician</button>
                <button class="mode-btn" data-mode="client">üë§ Client</button>
            </div>
        </div>

        <form id="repairForm" autocomplete="off">
            <div class="form-section">
                <div class="section-title">üè† Appliance Information</div>

                <div class="form-group">
                    <label class="label">
                        Appliance Type
                        <span class="translation">–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏</span>
                    </label>
                    <select id="category" required>
                        <option value="">Select Appliance Type</option>
                        <option value="refrigerator">Refrigerator / –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫</option>
                        <option value="dishwasher">Dishwasher / –ü–æ—Å—É–¥–æ–º–æ–µ—á–Ω–∞—è –º–∞—à–∏–Ω–∞</option>
                        <option value="washing_machine">Washing Machine / –°—Ç–∏—Ä–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞</option>
                        <option value="dryer">Dryer / –°—É—à–∏–ª–∫–∞</option>
                        <option value="stove_oven">Stove/Oven / –ü–ª–∏—Ç–∞/–î—É—Ö–æ–≤–∫–∞</option>
                        <option value="microwave">Microwave / –ú–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∫–∞</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="label">
                            Brand
                            <span class="translation">–ë—Ä–µ–Ω–¥</span>
                        </label>
                        <select id="brand" required>
                            <option value="">Select Brand</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="label">
                            Model
                            <span class="translation">–ú–æ–¥–µ–ª—å</span>
                        </label>
                        <input type="text" id="model" placeholder="Enter model number" required />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="label">
                            Serial Number
                            <span class="translation">–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä</span>
                        </label>
                        <input type="text" id="serial" placeholder="Enter serial number" />
                    </div>
                    <div class="form-group">
                        <label class="label">
                            Month of Manufacture
                            <span class="translation">–ú–µ—Å—è—Ü –≤—ã–ø—É—Å–∫–∞</span>
                        </label>
                        <select id="month">
                            <option value="">Select Month</option>
                            <option>January / –Ø–Ω–≤–∞—Ä—å</option>
                            <option>February / –§–µ–≤—Ä–∞–ª—å</option>
                            <option>March / –ú–∞—Ä—Ç</option>
                            <option>April / –ê–ø—Ä–µ–ª—å</option>
                            <option>May / –ú–∞–π</option>
                            <option>June / –ò—é–Ω—å</option>
                            <option>July / –ò—é–ª—å</option>
                            <option>August / –ê–≤–≥—É—Å—Ç</option>
                            <option>September / –°–µ–Ω—Ç—è–±—Ä—å</option>
                            <option>October / –û–∫—Ç—è–±—Ä—å</option>
                            <option>November / –ù–æ—è–±—Ä—å</option>
                            <option>December / –î–µ–∫–∞–±—Ä—å</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="label">
                            Year of Manufacture
                            <span class="translation">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞</span>
                        </label>
                        <input type="number" id="year" placeholder="2020" min="1990" max="2025" />
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">üîç Service Details</div>

                <div class="form-group" style="display:flex;align-items:flex-end;gap:8px;">
                    <div style="flex:1">
                        <label class="label">
                            Problem
                            <span class="translation">–ü—Ä–æ–±–ª–µ–º–∞</span>
                        </label>
                        <select id="problem" required>
                            <option value="">Select Problem</option>
                        </select>
                    </div>
                    <button type="button" class="btn btn-secondary" id="addProblemBtn" style="height:44px;padding:0 12px;min-width:44px;">+Add</button>
                </div>

                <div class="form-group" style="display:flex;align-items:flex-end;gap:8px;">
                    <div style="flex:1">
                        <label class="label">
                            Diagnosis
                            <span class="translation">–î–∏–∞–≥–Ω–æ–∑</span>
                        </label>
                        <select id="diagnosis" required>
                            <option value="">Select Diagnosis</option>
                        </select>
                    </div>
                    <button type="button" class="btn btn-secondary" id="addDiagnosisBtn" style="height:44px;padding:0 12px;min-width:44px;">+Add</button>
                </div>

                <div class="form-group" style="display:flex;align-items:flex-end;gap:8px;">
                    <div style="flex:1">
                        <label class="label">
                            Action Taken
                            <span class="translation">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</span>
                        </label>
                        <select id="action" required>
                            <option value="">Select Action</option>
                        </select>
                    </div>
                    <button type="button" class="btn btn-secondary" id="addActionBtn" style="height:44px;padding:0 12px;min-width:44px;">+Add</button>
                </div>

                <div class="form-group">
                    <label class="label">
                        Status
                        <span class="translation">–°—Ç–∞—Ç—É—Å</span>
                    </label>
                    <select id="status" required>
                        <option value="">Select Status</option>
                        <option value="completed">‚úÖ Fixed 100% / –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ</option>
                        <option value="waiting">‚è≥ Waiting for Part / –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏</option>
                        <option value="temporary">üîß Temporary Fix / –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ</option>
                        <option value="unrepairable">‚ùå Not Repairable / –ù–µ –ø–æ–¥–ª–µ–∂–∏—Ç —Ä–µ–º–æ–Ω—Ç—É</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="label">
                        Additional Notes
                        <span class="translation">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏</span>
                    </label>
                    <textarea id="notes" placeholder="Enter any additional details or recommendations..."></textarea>
                </div>

                <div class="form-group">
                    <label class="label">
                        Price
                        <span class="translation">–°—Ç–æ–∏–º–æ—Å—Ç—å</span>
                    </label>
                    <input type="number" id="price" placeholder="Enter price" min="0" step="1" />
                </div>
            </div>

            <div class="action-buttons">
                <button type="submit" class="btn btn-primary">üìã Generate Report</button>
                <button type="button" class="btn btn-secondary" id="clearBtn">üóëÔ∏è Clear Form</button>
            </div>
        </form>

        <div id="reportOutput" class="report-output hidden">
            <div class="report-title">üìÑ Service Report</div>
            <div id="reportContent" class="report-content"></div>
        </div>

        <div class="templates">
            <div class="templates-title">üí¨ Customer Message Templates</div>
            <button class="template-btn" data-template="completion">
                <div class="template-main">‚úÖ Service completed successfully - Your appliance is working perfectly</div>
                <div class="template-translation">‚úÖ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ - –í–∞—à–∞ —Ç–µ—Ö–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ</div>
            </button>
            <button class="template-btn" data-template="parts">
                <div class="template-main">üîß Part ordered - We'll return within 3-5 business days to complete the repair</div>
                <div class="template-translation">üîß –ó–∞–ø—á–∞—Å—Ç—å –∑–∞–∫–∞–∑–∞–Ω–∞ - –í–µ—Ä–Ω–µ–º—Å—è —á–µ—Ä–µ–∑ 3-5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–∞</div>
            </button>
            <button class="template-btn" data-template="estimate">
                <div class="template-main">üí∞ Repair estimate provided - Please review and let us know your decision</div>
                <div class="template-translation">üí∞ –°–º–µ—Ç–∞ —Ä–µ–º–æ–Ω—Ç–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ - –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏ —Å–æ–æ–±—â–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ</div>
            </button>
            <button class="template-btn" data-template="warranty">
                <div class="template-main">üõ°Ô∏è Repair covered under warranty - No charge for today's service</div>
                <div class="template-translation">üõ°Ô∏è –†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏–µ–π - –°–µ–≥–æ–¥–Ω—è—à–Ω–µ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
            </button>
        </div>
    </div>

    <div class="install-prompt" id="installPrompt">
        <div class="install-text">üì± Install this app on your home screen for quick access!</div>
        <div class="install-buttons">
            <button class="install-btn" id="installBtn">Install</button>
            <button class="close-btn" id="closePrompt">Close</button>
        </div>
    </div>

  <script>
const applianceData = {
    refrigerator: {
        brands: ['GE','Samsung','Whirlpool','LG','Kenmore','KitchenAid','Frigidaire','Maytag','Bosch','Electrolux','Haier','Panasonic','Beko','Hotpoint','Indesit','Miele','Ariston','Sharp','Smeg','Hitachi'],
        problems: [
            { en:"Not cooling properly", ru:"–ù–µ –æ—Ö–ª–∞–∂–¥–∞–µ—Ç –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º" },
            { en:"Making loud noises", ru:"–ò–∑–¥–∞–µ—Ç –≥—Ä–æ–º–∫–∏–µ –∑–≤—É–∫–∏" },
            { en:"Leaking water", ru:"–¢–µ—á–µ—Ç –≤–æ–¥–∞" },
            { en:"Ice maker not working", ru:"–õ—å–¥–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç" },
            { en:"Defrost issues", ru:"–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞–∑–º–æ—Ä–æ–∑–∫–∞" },
            { en:"Compressor running constantly", ru:"–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ" },
            { en:"Odors in fridge", ru:"–ó–∞–ø–∞—Ö–∏ –≤–Ω—É—Ç—Ä–∏" },
            { en:"Food freezing", ru:"–ó–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã" },
            { en:"Water dispenser failure", ru:"–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞–∑–¥–∞—Ç—á–∏–∫ –≤–æ–¥—ã" },
            { en:"Control panel unresponsive", ru:"–ü–∞–Ω–µ–ª—å –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç" },
            { en:"Door not closing", ru:"–î–≤–µ—Ä—å –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è" },
            { en:"Evaporator fan noise", ru:"–®—É–º –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ –∏—Å–ø–∞—Ä–∏—Ç–µ–ª—è" }
        ],
        diagnosis: [
            { en:"Faulty compressor", ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–Ω—ã–π –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä" },
            { en:"Refrigerant leak", ru:"–£—Ç–µ—á–∫–∞ —Ö–ª–∞–¥–∞–≥–µ–Ω—Ç–∞" },
            { en:"Defrost timer failure", ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω —Ç–∞–π–º–µ—Ä —Ä–∞–∑–º–æ—Ä–æ–∑–∫–∏" },
            { en:"Clogged drain", ru:"–ó–∞—Å–æ—Ä –¥—Ä–µ–Ω–∞–∂–∞" },
            { en:"Broken fan motor", ru:"–°–ª–æ–º–∞–Ω –º–æ—Ç–æ—Ä –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞" }
        ],
        actions: [
            { en:"Replaced compressor", ru:"–ó–∞–º–µ–Ω–µ–Ω –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä" },
            { en:"Repaired leak + refill", ru:"–ó–∞–ø—Ä–∞–≤–ª–µ–Ω —Ñ—Ä–µ–æ–Ω, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ —É—Ç–µ—á–∫–∞" },
            { en:"Cleared drain", ru:"–ü—Ä–æ–≤–µ–¥–µ–Ω –ø—Ä–æ—á–∏—Å—Ç–∫–∞ –¥—Ä–µ–Ω–∞–∂–∞" },
            { en:"Installed new fan", ru:"–ó–∞–º–µ–Ω–µ–Ω –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä" },
            { en:"Replaced door gasket", ru:"–ó–∞–º–µ–Ω–∏–ª–∏ —É–ø–ª–æ—Ç–Ω–∏—Ç–µ–ª—å –¥–≤–µ—Ä–∏" }
        ]
    },
    dishwasher: {
        brands: ['GE','Samsung','Whirlpool','LG','Kenmore','Bosch','Siemens','Electrolux','Beko','Miele','Hotpoint','Indesit','Ariston','Zanussi','Candy','Sharp','Viking','Daewoo','Smeg'],
        problems: [
            { en:"Not draining water", ru:"–ù–µ —Å–ª–∏–≤–∞–µ—Ç –≤–æ–¥—É" },
            { en:"Dishes not getting clean", ru:"–ü–æ—Å—É–¥–∞ –Ω–µ –æ—Ç–º—ã–≤–∞–µ—Ç—Å—è" },
            { en:"Leaking", ru:"–¢–µ—á–µ—Ç" },
            { en:"No power", ru:"–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è" },
            { en:"Filling with water continuously", ru:"–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –Ω–∞–±–∏—Ä–∞–µ—Ç –≤–æ–¥—É" },
            { en:"Door not latching", ru:"–î–≤–µ—Ä—å –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è" }
        ],
        diagnosis: [
            {en:"Clogged drain hose",ru:"–ó–∞–±–∏—Ç —Å–ª–∏–≤–Ω–æ–π —à–ª–∞–Ω–≥"},
            {en:"Defective drain pump",ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω —Å–ª–∏–≤–Ω–æ–π –Ω–∞—Å–æ—Å"},
            {en:"Broken door switch",ru:"–î–∞—Ç—á–∏–∫ –¥–≤–µ—Ä–∏ –Ω–µ–∏—Å–ø—Ä–∞–≤–µ–Ω"},
            {en:"Blocked spray arms",ru:"–ó–∞—Å–æ—Ä —Ä–∞—Å–ø—ã–ª–∏—Ç–µ–ª–µ–π"}
        ],
        actions: [
            {en:"Cleaned hose",ru:"–ü—Ä–æ–º—ã–ª–∏ —à–ª–∞–Ω–≥"},
            {en:"Replaced pump",ru:"–ü–æ–º–µ–Ω—è–Ω –Ω–∞—Å–æ—Å"},
            {en:"Replaced latch",ru:"–ü–æ–º–µ–Ω—è–ª–∏ –∑–∞–º–æ–∫"},
            {en:"Fixed spray arms",ru:"–û—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω —Ä–∞—Å–ø—ã–ª–∏—Ç–µ–ª—å"}
        ]
    },
    washing_machine: {
        brands: ['LG','Samsung','Whirlpool','Bosch','Electrolux','Indesit','Hotpoint','Candy','Beko','Zanussi', 'Ardo','Siemens','Miele','AEG','Ariston','Vestfrost','Haier','Daewoo','Sharp','Panasonic'],
        problems:[
            {en:"Won't start", ru:"–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è"},
            {en:"Water leaks", ru:"–¢–µ—á–µ—Ç"},
            {en:"Not spinning", ru:"–ù–µ –∫—Ä—É—Ç–∏—Ç"},
            {en:"No water intake", ru:"–ù–µ—Ç –Ω–∞–±–æ—Ä–∞ –≤–æ–¥—ã"},
            {en:"Jumps/vibrates", ru:"–ü—Ä—ã–≥–∞–µ—Ç/–≤–∏–±—Ä–∏—Ä—É–µ—Ç"},
            {en:"Doesn't heat", ru:"–ù–µ –≥—Ä–µ–µ—Ç"},
            {en:"Stains on laundry", ru:"–ü—è—Ç–Ω–∞ –Ω–∞ –±–µ–ª—å–µ"},
            {en:"Controller error", ru:"–û—à–∏–±–∫–∞ –Ω–∞ –ø–∞–Ω–µ–ª–∏"}
        ],
        diagnosis:[
            {en:"Pump motor fails", ru:"–°–ª–æ–º–∞–Ω –º–æ—Ç–æ—Ä –Ω–∞—Å–æ—Å–∞"},
            {en:"Drive belt snapped", ru:"–ü–æ—Ä–≤–∞–ª—Å—è —Ä–µ–º–µ–Ω—å"},
            {en:"Shock absorbers broken", ru:"–ò–∑–Ω–æ—Å –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä–∞"},
            {en:"Heating element burnt", ru:"–°–≥–æ—Ä–µ–ª —Ç–µ–Ω"},
            {en:"Door interlock fault", ru:"–ë–ª–æ–∫–∏—Ä–∞—Ç–æ—Ä –¥–≤–µ—Ä–∏"}
        ],
        actions:[
            {en:"Replaced bearing", ru:"–ó–∞–º–µ–Ω–µ–Ω –ø–æ–¥—à–∏–ø–Ω–∏–∫"},
            {en:"Reinstalled drive belt", ru:"–ù–æ–≤—ã–π —Ä–µ–º–µ–Ω—å"},
            {en:"Fixed pump", ru:"–ü–æ—á–∏–Ω–∏–ª–∏ –Ω–∞—Å–æ—Å"},
            {en:"Mounted new shock absorber", ru:"–ü–æ—Å—Ç–∞–≤–∏–ª–∏ –∞–º–æ—Ä—Ç–∏–∑–∞—Ç–æ—Ä"},
            {en:"Changed heating element", ru:"–°–º–µ–Ω–∏–ª–∏ —Ç–µ–Ω"}
        ]
    },
    dryer: {
        brands: ["LG","Samsung","Whirlpool","Bosch","Electrolux","Hotpoint","Indesit","Maytag","AEG","Beko","Siemens","Miele","Candy","Sharp","Panasonic","Ariston","Zanussi","Haier","Ardo","Daewoo"],
        problems:[
            {en:"Not heating",ru:"–ù–µ –≥—Ä–µ–µ—Ç"},
            {en:"Does not start",ru:"–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è"},
            {en:"Drum not turning",ru:"–ë–∞—Ä–∞–±–∞–Ω –Ω–µ –∫—Ä—É—Ç–∏—Ç—Å—è"},
            {en:"Unusual noise",ru:"–°—Ç—Ä–∞–Ω–Ω—ã–π —à—É–º"},
            {en:"Stops mid-cycle",ru:"–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ"},
            {en:"Door won‚Äôt close",ru:"–î–≤–µ—Ä—å –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è"}
        ],
        diagnosis:[
            {en:"Blown thermal fuse",ru:"–°–≥–æ—Ä–µ–ª —Ç–µ—Ä–º–æ–ø—Ä–µ–¥"},
            {en:"Broken drive belt",ru:"–†–µ–º–µ–Ω—å –ø–æ—Ä–≤–∞–ª—Å—è"},
            {en:"Clogged venting",ru:"–ó–∞–±–∏—Ç—ã –≤–æ–∑–¥—É—Ö–æ–≤–æ–¥—ã"},
            {en:"Defective door switch",ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω –¥–∞—Ç—á–∏–∫ –¥–≤–µ—Ä–∏"}
        ],
        actions:[
            {en:"Replaced thermal fuse",ru:"–ü–æ–º–µ–Ω—è–ª–∏ —Ç–µ—Ä–º–æ–ø—Ä–µ–¥"},
            {en:"New drive belt installed",ru:"–ü–æ—Å—Ç–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ä–µ–º–µ–Ω—å"},
            {en:"Cleaned vent",ru:"–ü–æ—á–∏—â–µ–Ω –∫–∞–Ω–∞–ª"},
            {en:"Changed door switch",ru:"–ü–æ–º–µ–Ω—è–ª–∏ –¥–∞—Ç—á–∏–∫ –¥–≤–µ—Ä–∏"}
        ]
    },
    stove_oven: {
        brands: ["GE","Whirlpool","Bosch","Samsung","Electrolux","Beko","Hotpoint","Indesit","Zanussi","Ariston","Gorenje","Miele","Candy","Siemens","Sharp","Smeg","Panasonic","Vestfrost","Hansa","AEG"],
        problems:[
            {en:"No heating",ru:"–ù–µ—Ç –Ω–∞–≥—Ä–µ–≤–∞"},
            {en:"Burners not igniting",ru:"–ù–µ –∑–∞–∂–∏–≥–∞—é—Ç—Å—è –≥–æ—Ä–µ–ª–∫–∏"},
            {en:"Oven not baking evenly",ru:"–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è –≤—ã–ø–µ—á–∫–∞"},
            {en:"Door does not seal",ru:"–î–≤–µ—Ä—Ü–∞ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è"},
            {en:"Knobs loose",ru:"–ö—Ä—É—Ç–∏–ª–∫–∏ –ª—é—Ñ—Ç—è—Ç"}
        ],
        diagnosis:[
            {en:"Faulty igniter",ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω –≤–æ—Å–ø–ª–∞–º–µ–Ω–∏—Ç–µ–ª—å"},
            {en:"Defective thermostat",ru:"–ü–ª–æ—Ö–æ–π —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç"},
            {en:"Heating element burnt",ru:"–°–≥–æ—Ä–µ–ª —Ç–µ–Ω"},
            {en:"Broken door hinge",ru:"–ü–µ—Ç–ª—è —Å–ª–æ–º–∞–Ω–∞"}
        ],
        actions:[
            {en:"Replaced igniter",ru:"–ó–∞–º–µ–Ω–∞ –≤–æ—Å–ø–ª–∞–º–µ–Ω–∏—Ç–µ–ª—è"},
            {en:"Fixed thermostat",ru:"–¢–µ—Ä–º–æ—Å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–∏–ª–∏"},
            {en:"Replaced heater",ru:"–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ç–µ–Ω"},
            {en:"Rehung door",ru:"–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –¥–≤–µ—Ä—å"}
        ]
    },
    microwave: {
        brands:["Samsung","LG","Panasonic","Sharp","Whirlpool","Bosch","Beko","Hotpoint","Candy","Midea","Daewoo","Siemens","Electrolux","Zanussi","Toshiba","Gorenje","Vestfrost","Ardo","Smeg","Mystery"],
        problems:[
            {en:"No heating",ru:"–ù–µ –≥—Ä–µ–µ—Ç"},
            {en:"Sparking inside",ru:"–ò—Å–∫—Ä–∏—Ç"},
            {en:"Turntable not rotating",ru:"–¢–∞—Ä–µ–ª–∫–∞ –Ω–µ –∫—Ä—É—Ç–∏—Ç—Å—è"},
            {en:"Buttons not working",ru:"–ö–Ω–æ–ø–∫–∏ –Ω–µ —Ä–µ–∞–≥–∏—Ä—É—é—Ç"},
            {en:"Loud noise",ru:"–ì—Ä–æ–º–∫–æ —Ä–∞–±–æ—Ç–∞–µ—Ç"}
        ],
        diagnosis:[
            {en:"Magnetron failure",ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω –º–∞–≥–Ω–µ—Ç—Ä–æ–Ω"},
            {en:"Faulty door switch",ru:"–ü—Ä–æ–±–ª–µ–º–∞ –¥–≤–µ—Ä–∏"},
            {en:"Broken turntable motor",ru:"–ú–æ—Ç–æ—Ä —Ç–∞—Ä–µ–ª–∫–∏ —Å–ª–æ–º–∞–Ω"}
        ],
        actions:[
            {en:"Replaced magnetron",ru:"–ü–æ–º–µ–Ω—è–ª–∏ –º–∞–≥–Ω–µ—Ç—Ä–æ–Ω"},
            {en:"Changed door switch",ru:"–î–∞—Ç—á–∏–∫ –¥–≤–µ—Ä–∏"},
            {en:"New turntable motor",ru:"–ü–æ—Å—Ç–∞–≤–∏–ª–∏ –º–æ—Ç–æ—Ä —Ç–∞—Ä–µ–ª–∫–∏"}
        ]
    }
};

// –ö–ª—é—á–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è custom-–¥–∞–Ω–Ω—ã—Ö –∏ –∏—Å—Ç–æ—Ä–∏–∏ –≤ localStorage:
const LS_KEYS = {
    PROBLEMS: 'arpro_custom_problems',
    DIAGNOSIS: 'arpro_custom_diagnosis',
    ACTIONS: 'arpro_custom_actions',
    REPORTS: 'arpro_reports_history'
};
// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è custom-–¥–∞–Ω–Ω—ã—Ö
function loadCustom(type){
    try{ return JSON.parse(localStorage.getItem(type)) || {}; } catch(e){return {};}
}
function saveCustom(type,obj){
    localStorage.setItem(type,JSON.stringify(obj));
}
function loadReports(){
    try{ return JSON.parse(localStorage.getItem(LS_KEYS.REPORTS)) || [];}catch(e){return[];}
}
function saveReports(arr){
    localStorage.setItem(LS_KEYS.REPORTS,JSON.stringify(arr));
}

let reportsArr = loadReports();

// === DOM Elements ===
const categorySelect = document.getElementById('category');
const brandSelect = document.getElementById('brand');
const problemSelect = document.getElementById('problem');
const diagnosisSelect = document.getElementById('diagnosis');
const actionSelect = document.getElementById('action');
const form = document.getElementById('repairForm');
const clearBtn = document.getElementById('clearBtn');

// --------- –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–ø–∏—Å–∫–∏ ----------------
let customProblems = loadCustom(LS_KEYS.PROBLEMS);
let customDiagnosis = loadCustom(LS_KEYS.DIAGNOSIS);
let customActions = loadCustom(LS_KEYS.ACTIONS);

// ------- –§–£–ù–ö–¶–ò–ò —Å–º–µ–Ω—ã –∏ –æ—Ç—Ä–∏—Å–æ–≤–æ–∫ ---------
function reloadSelect(select, arr, customs, key){
    select.innerHTML = `<option value="">Select ${key.charAt(0).toUpperCase()+key.slice(1)}</option>`;
    arr.forEach(obj=>{
        select.insertAdjacentHTML('beforeend',
            `<option>${obj.en} / ${obj.ru}</option>`
        );
    });
    // –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    const cc = customs[categorySelect.value]||[];
    cc.forEach(({en,ru},i)=>{
        select.insertAdjacentHTML('beforeend',
            `<option data-custom="1" data-idx="${i}">${en}${ru?' / '+ru:''} ‚òÖ</option>`);
    });
}
function updateAllCategoryFields(){
    const c = categorySelect.value;
    if(!c || !applianceData[c]) {
        brandSelect.innerHTML='<option value="">Select Brand</option>';
        reloadSelect(problemSelect,[],customProblems,'problem');
        reloadSelect(diagnosisSelect,[],customDiagnosis,'diagnosis');
        reloadSelect(actionSelect,[],customActions,'action');
        return;
    }
    // Brands
    brandSelect.innerHTML='<option value="">Select Brand</option>';
    applianceData[c].brands.forEach(br=>{
        let op=document.createElement('option');
        op.value=br;
        op.textContent=br;
        brandSelect.appendChild(op);
    });
    // Problem-type selects
    reloadSelect(problemSelect,applianceData[c].problems,customProblems,'problem');
    reloadSelect(diagnosisSelect,applianceData[c].diagnosis,customDiagnosis,'diagnosis');
    reloadSelect(actionSelect,applianceData[c].actions,customActions,'action');
}

// --- –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø—É–Ω–∫—Ç ---
function addCustomField(type,select,collection,transl){
    let en = prompt(`Enter your custom ${type} in English:`);
    if(!en) return;
    let ru = prompt(`–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π (${type}):`)||'';
    let arr = collection[categorySelect.value] || [];
    arr.push({en,ru});
    collection[categorySelect.value]=arr;
    saveCustom(LS_KEYS[type.toUpperCase()],collection);
    updateAllCategoryFields();
    // active select new
    select.selectedIndex=select.options.length-1;
}
function removeCustomField(type,select,collection){
    // —É–¥–∞–ª–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø—É–Ω–∫—Ç
    let idx = select.selectedIndex;
    let opt = select.options[idx];
    if(idx>-1 && opt && opt.dataset.custom){
        if(confirm('Remove this custom entry?')){
            let arr = collection[categorySelect.value] || [];
            arr.splice(opt.dataset.idx,1);
            collection[categorySelect.value]=arr;
            saveCustom(LS_KEYS[type.toUpperCase()],collection);
            updateAllCategoryFields();
        }
    }
}

// === HANDLERS select, custom add & remove ===
categorySelect.addEventListener('change',()=>{
    updateAllCategoryFields();
});

document.getElementById('addProblemBtn').onclick=()=>{
    addCustomField('problems',problemSelect,customProblems,'Problem');
};
document.getElementById('addDiagnosisBtn').onclick=()=>{
    addCustomField('diagnosis',diagnosisSelect,customDiagnosis,'Diagnosis');
};
document.getElementById('addActionBtn').onclick=()=>{
    addCustomField('actions',actionSelect,customActions,'Action');
};

// –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø—É–Ω–∫—Ç–∞ –ø—Ä–∏ –∑–∞–∂–∞—Ç–∏–∏ Alt+–∫–ª–∏–∫ –ø–æ —Å–µ–ª–µ–∫—Ç—É
[problemSelect,diagnosisSelect,actionSelect].forEach((sel,i)=>{
    sel.addEventListener('keydown',e=>{
        if(e.key==='Delete'){
            ['problems','diagnosis','actions'].forEach((t,n)=>{
                if(i===n) removeCustomField(t,sel,
                    t==='problems'?customProblems:t==='diagnosis'?customDiagnosis:customActions );
            });
        }
    });
});

// -------- –û–¢–ß–ï–¢–´, –∏—Å—Ç–æ—Ä–∏—è, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ --------
function getCurrentReport(){
    return {
        date:new Date().toLocaleString(),
        appliance: categorySelect.options[categorySelect.selectedIndex]?.text ?? '',
        brand: brandSelect.options[brandSelect.selectedIndex]?.text ?? '',
        model: document.getElementById('model').value.trim(),
        serial: document.getElementById('serial').value.trim(),
        month: document.getElementById('month').value,
        year: document.getElementById('year').value.trim(),
        problem: problemSelect.options[problemSelect.selectedIndex]?.text ?? '',
        diagnosis: diagnosisSelect.options[diagnosisSelect.selectedIndex]?.text ?? '',
        action: actionSelect.options[actionSelect.selectedIndex]?.text ?? '',
        status: document.getElementById('status').options[document.getElementById('status').selectedIndex]?.text ?? '',
        notes: document.getElementById('notes').value.trim(),
        price: document.getElementById('price').value.trim()
    };
}
function reportToText(r){
    return `[${r.appliance}]
Brand: ${r.brand}
Model: ${r.model}
Serial#: ${r.serial}
Month: ${r.month}
Year: ${r.year}
Problem: ${r.problem}
Diagnosis: ${r.diagnosis}
Action: ${r.action}
Status: ${r.status}
Notes: ${r.notes}
Price: ${r.price}
Date: ${r.date}`.trim();
}
function renderAllReports(){
    let out = '';
    reportsArr.forEach((r,idx) => out+=`
        <div class="report-output" style="margin-top:24px;">
          <div class="report-title">üìÑ Report #${idx+1}</div>
          <div class="report-content">
             <div class="report-line"><span class="report-label">Date:</span> <span class="report-value">${r.date||''}</span></div>
             <div class="report-line"><span class="report-label">Appliance Type:</span> <span class="report-value">${r.appliance}</span></div>
             <div class="report-line"><span class="report-label">Brand:</span> <span class="report-value">${r.brand}</span></div>
             <div class="report-line"><span class="report-label">Model:</span> <span class="report-value">${r.model}</span></div>
             <div class="report-line"><span class="report-label">Serial:</span> <span class="report-value">${r.serial}</span></div>
             <div class="report-line"><span class="report-label">Month of Manufacture:</span> <span class="report-value">${r.month}</span></div>
             <div class="report-line"><span class="report-label">Year of Manufacture:</span> <span class="report-value">${r.year}</span></div>
             <div class="report-line"><span class="report-label">Problem:</span> <span class="report-value">${r.problem}</span></div>
             <div class="report-line"><span class="report-label">Diagnosis:</span> <span class="report-value">${r.diagnosis}</span></div>
             <div class="report-line"><span class="report-label">Action Taken:</span> <span class="report-value">${r.action}</span></div>
             <div class="report-line"><span class="report-label">Status:</span> <span class="report-value">${r.status}</span></div>
             <div class="report-line"><span class="report-label">Additional Notes:</span> <span class="report-value">${r.notes}</span></div>
             <div class="report-line"><span class="report-label">Price:</span> <span class="report-value">${r.price}</span></div>
          </div>
        </div>`);
    document.getElementById('allReportsBlock').innerHTML = out;
    document.getElementById('reportsControlBtns').classList.toggle('hidden', reportsArr.length === 0);
}
// --- –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ ---

if (!document.getElementById('allReportsBlock')) {
    // –í—Å—Ç–∞–≤–∏–º –ø–æ–¥ form
    let repBlock = document.createElement('div');
    repBlock.id = 'reportsControlBtns';
    repBlock.className = 'action-buttons hidden';
    repBlock.innerHTML = `
        <button type="button" class="btn btn-primary" id="copyAllBtn">üìë Copy All Reports</button>
        <button type="button" class="btn btn-primary" id="copyLastBtn">üìã Copy Last Report</button>
        <button type="button" class="btn btn-secondary" id="clearAllBtn">üóëÔ∏è Clear All Reports</button>
    `;
    form.parentNode.insertBefore(repBlock, form.nextSibling);

    let allRepHtml = document.createElement('div');
    allRepHtml.id = 'allReportsBlock';
    form.parentNode.insertBefore(allRepHtml, repBlock.nextSibling);

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º/–æ—á–∏—Å—Ç–∫–æ–π
    repBlock.querySelector('#copyAllBtn').onclick = () => {
        if(reportsArr.length) navigator.clipboard.writeText(reportsArr.map(reportToText).join('\n\n====\n\n'));
    };
    repBlock.querySelector('#copyLastBtn').onclick = () => {
        if(reportsArr.length) navigator.clipboard.writeText(reportToText(reportsArr[reportsArr.length-1]));
    };
    repBlock.querySelector('#clearAllBtn').onclick = () => {
        if(confirm('Clear ALL reports?')){
            reportsArr.length = 0; renderAllReports(); saveReports(reportsArr);
        }
    };
}

// --- —Å–∞–±–º–∏—Ç –∏ –æ—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã ---
form.addEventListener('submit', e => {
    e.preventDefault();
    const report = getCurrentReport();
    reportsArr.push(report);
    saveReports(reportsArr);
    renderAllReports();
    form.reset();
    updateAllCategoryFields();
});
clearBtn.addEventListener('click', () => {
    form.reset();
    // –æ–±–Ω—É–ª–∏–º —Å–µ–ª–µ–∫—Ç—ã –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞
    updateAllCategoryFields();
});
// --- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ ---
window.addEventListener('DOMContentLoaded',()=>{
    renderAllReports();
    updateAllCategoryFields();
    // –†–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî Technician
    document.querySelectorAll('.translation').forEach(el=>el.classList.remove('hidden'));
    // ENTER —É–¥–∞–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º –ø—É–Ω–∫—Ç –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞)
    [problemSelect,diagnosisSelect,actionSelect].forEach((sel,i)=>{
        sel.onkeydown=e=>{
            if(e.key==='Delete'){
                ['problems','diagnosis','actions'].forEach((t,n)=>{
                    if(i===n) removeCustomField(t,sel,
                        t==='problems'?customProblems:t==='diagnosis'?customDiagnosis:customActions );
                });
            }
        };
    })
});

// --- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ ---
const modeButtons = document.querySelectorAll('.mode-btn');
modeButtons.forEach(button => {
    button.addEventListener('click', () => {
        modeButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        const isClient = button.getAttribute('data-mode') === 'client';
        document.querySelectorAll('.translation').forEach(el=>{
            if(isClient) el.classList.add('hidden');
            else el.classList.remove('hidden');
        });
    });
});

</script>
</body>
</html>
