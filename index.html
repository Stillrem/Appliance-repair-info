<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>Appliance Repair Pro (Upgraded)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<style>
:root { --primary: #34c759; --primary-dark: #30d158; --background: #000000; --surface: #1c1c1e; --surface-2: #2c2c2e;
--surface-3: #3a3a3c; --text: #ffffff; --text-secondary: #8e8e93; --border: #2c2c2e; --shadow: rgba(0,0,0,0.3);}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;background:var(--background);color:var(--text);min-height:100vh;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);}
.container{max-width:100%;padding:20px;margin:0 auto;min-height:100vh;}
.header{text-align:center;margin-bottom:30px;padding:20px 0;}
.logo{width:60px;height:60px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-radius:15px;margin:0 auto 15px;display:flex;align-items:center;justify-content:center;font-size:24px;box-shadow:0 8px 32px rgba(52,199,89,0.3);}
.title{font-size:28px;font-weight:700;margin-bottom:8px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.subtitle{color:var(--text-secondary);font-size:16px;font-weight:500;}
.mode-toggle{display:flex;background:var(--surface);border-radius:12px;padding:4px;margin:25px 0;box-shadow:inset 0 1px 3px var(--shadow);}
.mode-btn{flex:1;padding:12px 16px;border:none;background:transparent;color:var(--text-secondary);border-radius:8px;font-weight:600;font-size:15px;transition:all 0.3s cubic-bezier(.25,.46,.45,.94);cursor:pointer;}
.mode-btn.active{background:var(--primary);color:var(--text);box-shadow:0 2px 8px rgba(52,199,89,0.3);transform:scale(1.02);}
.form-section{background:var(--surface);border-radius:16px;padding:24px;margin-bottom:20px;border:1px solid var(--border);box-shadow:0 4px 16px rgba(0,0,0,0.1);}
.section-title{font-size:18px;font-weight:700;color:var(--primary);margin-bottom:20px;display:flex;align-items:center;gap:8px;}
.form-group{margin-bottom:20px;}
.form-group:last-child{margin-bottom:0;}
.label{display:block;font-weight:600;margin-bottom:8px;color:var(--text);font-size:16px;}
.translation{color:var(--text-secondary);font-size:14px;font-style:italic;display:block;margin-top:2px;}
.translation.hidden{display:none;}
select,input,textarea{width:100%;padding:16px;background:var(--surface-2);border:1.5px solid var(--border);border-radius:12px;color:var(--text);font-size:16px;font-family:inherit;transition:all 0.3s ease;-webkit-appearance:none;appearance:none;}
select{background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 12px center;background-size:20px;padding-right:50px;cursor:pointer;}
select:focus,input:focus,textarea:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(52,199,89,0.1);transform:translateY(-1px);}
input::placeholder,textarea::placeholder{color:var(--text-secondary);}
textarea{min-height:100px;resize:vertical;line-height:1.5;}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:15px;}
.action-buttons{display:flex;gap:12px;margin-top:30px;}
.btn{flex:1;padding:16px 24px;border:none;border-radius:12px;font-weight:600;font-size:16px;transition:all 0.3s cubic-bezier(.25,.46,.45,.94);cursor:pointer;position:relative;overflow:hidden;}
.btn:active{transform:scale(0.98);}
.btn-primary{background:linear-gradient(135deg, var(--primary), var(--primary-dark));color:var(--text);box-shadow:0 4px 16px rgba(52,199,89,0.3);}
.btn-primary:hover{box-shadow:0 6px 20px rgba(52,199,89,0.4);transform:translateY(-2px);}
.btn-secondary{background:var(--surface-2);color:var(--text);border:1px solid var(--border);}
.btn-secondary:hover{background:var(--surface-3);transform:translateY(-1px);}
.report-output{background:var(--surface);border-radius:16px;padding:24px;margin-top:30px;border:1px solid var(--border);box-shadow:0 4px 16px rgba(0,0,0,0.1);}
.report-title{font-size:20px;font-weight:700;margin-bottom:20px;color:var(--primary);}
.report-content{line-height:1.8;}
.report-line{margin-bottom:12px;padding:12px 0;border-bottom:1px solid var(--border);}
.report-line:last-child{border-bottom:none;margin-bottom:0;}
.report-label{font-weight:600;color:var(--text-secondary);font-size:14px;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;}
.report-value{font-size:16px;color:var(--text);}
.templates{margin-top:30px;}
.templates-title{font-size:18px;font-weight:700;color:var(--primary);margin-bottom:15px;display:flex;align-items:center;gap:8px;}
.template-btn{width:100%;padding:16px;background:var(--surface-2);border:1px solid var(--border);border-radius:12px;color:var(--text);text-align:left;margin-bottom:12px;font-size:15px;cursor:pointer;transition:all 0.3s ease;line-height:1.4;}
.template-btn:hover{background:var(--surface-3);border-color:var(--primary);transform:translateY(-1px);}
.template-btn:active{transform:scale(0.98);}
.template-main{font-weight:600;margin-bottom:4px;}
.template-translation{color:var(--text-secondary);font-size:13px;}
.hidden{display:none !important;}
.input-dollar { position:relative; display: flex; align-items:center;}
.input-dollar .dollar-sign { 
  display:inline-block; width:28px; min-width:28px; text-align:center;
  font-size:18px; color:#aaa; pointer-events:none; margin-right:2px; line-height:1; padding-top:0;
}
.input-dollar input[type="number"]{padding-left:0;flex:1;}
.select-group {display:flex;align-items:center;gap:3px;}
.form-group .custom-add-btn {margin-bottom: -2px;}
.custom-add-btn {
  background:var(--primary);color:#fff;border:none;border-radius:6px;padding:4px 8px;cursor:pointer;font-size:18px;vertical-align:middle;
  transition:background 0.2s; outline:none;
}
.custom-add-btn:hover { background:var(--primary-dark);}
.custom-del-btn {
  background: #fc3c3c; color:#fff; border: none; border-radius: 6px; padding:4px 8px;font-size:18px;cursor:pointer;transition:background 0.2s;outline:none;display:inline-block;vertical-align:middle; margin-left:2px;
}
.custom-del-btn:hover { background: #e02f2f;}
@media (max-width:480px){.container{padding:15px;}.title{font-size:24px;}.form-row{grid-template-columns:1fr;gap:12px;}.action-buttons{flex-direction:column;}.btn{padding:14px 20px;}}
@media (min-width:768px){.container{max-width:600px;}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="logo">üîß</div>
    <h1 class="title">Appliance Repair Pro</h1>
    <p class="subtitle">Professional Service Reports</p>
    <div class="mode-toggle">
      <button class="mode-btn active" data-mode="technician">üë®‚Äçüîß Technician</button>
      <button class="mode-btn" data-mode="client">üë§ Client</button>
    </div>
  </div>
  <form id="repairForm" autocomplete="off">
    <div class="form-section">
      <div class="section-title">üè† Appliance Information</div>
      <div class="form-group">
        <label class="label">Appliance Type <span class="translation">–¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏</span></label>
        <select id="category" required>
          <option value="">Select Appliance Type</option>
          <option value="refrigerator">Refrigerator / –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫</option>
          <option value="dishwasher">Dishwasher / –ü–æ—Å—É–¥–æ–º–æ–µ—á–Ω–∞—è –º–∞—à–∏–Ω–∞</option>
          <option value="washing_machine">Washing Machine / –°—Ç–∏—Ä–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞</option>
          <option value="dryer">Dryer / –°—É—à–∏–ª–∫–∞</option>
          <option value="stove_oven">Stove/Oven / –ü–ª–∏—Ç–∞/–î—É—Ö–æ–≤–∫–∞</option>
          <option value="microwave">Microwave / –ú–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∫–∞</option>
        </select>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="label">Brand <span class="translation">–ë—Ä–µ–Ω–¥</span></label>
          <select id="brand" required>
            <option value="">Select Brand</option>
          </select>
        </div>
        <div class="form-group">
          <label class="label">Model <span class="translation">–ú–æ–¥–µ–ª—å</span></label>
          <input type="text" id="model" placeholder="Enter model number" required />
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="label">Serial Number <span class="translation">–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä</span></label>
          <input type="text" id="serial" placeholder="Enter serial number" />
        </div>
        <div class="form-group">
          <label class="label">Month/Year <span class="translation">–ú–µ—Å—è—Ü/–ì–æ–¥ (MM.YYYY)</span></label>
          <input type="text" id="month_year" placeholder="MM.YYYY" pattern="^(0[1-9]|1[0-2])\\.20[0-9]{2}$" maxlength="7"/>
        </div>
      </div>
      <div class="form-group">
        <label class="label">Year of Manufacture <span class="translation">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞</span></label>
        <input type="text" id="year" placeholder="2020"/>
      </div>
    </div>
    <div class="form-section">
      <div class="section-title">üîç Service Details</div>
      <div class="form-group">
        <label class="label">Problem <span class="translation">–ü—Ä–æ–±–ª–µ–º–∞</span></label>
        <div class="select-group">
          <select id="problem" required style="flex:1"><option value="">Select Problem</option></select>
          <button type="button" class="custom-add-btn" title="Add Problem Option" onclick="promptAddCustom('problem')">+</button>
          <button type="button" class="custom-del-btn" id="delCustomProblem" style="display:none;" title="Delete this custom option">üóëÔ∏è</button>
        </div>
      </div>
      <div class="form-group">
        <label class="label">Diagnosis <span class="translation">–î–∏–∞–≥–Ω–æ–∑</span></label>
        <div class="select-group">
          <select id="diagnosis" required style="flex:1"><option value="">Select Diagnosis</option></select>
          <button type="button" class="custom-add-btn" title="Add Diagnosis Option" onclick="promptAddCustom('diagnosis')">+</button>
          <button type="button" class="custom-del-btn" id="delCustomDiagnosis" style="display:none;" title="Delete this custom option">üóëÔ∏è</button>
        </div>
      </div>
      <div class="form-group">
        <label class="label">Action Taken <span class="translation">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</span></label>
        <div class="select-group">
          <select id="action" required style="flex:1"><option value="">Select Action</option></select>
          <button type="button" class="custom-add-btn" title="Add Action Option" onclick="promptAddCustom('action')">+</button>
          <button type="button" class="custom-del-btn" id="delCustomAction" style="display:none;" title="Delete this custom option">üóëÔ∏è</button>
        </div>
      </div>
      <div class="form-group">
        <label class="label">Status <span class="translation">–°—Ç–∞—Ç—É—Å</span></label>
        <select id="status" required>
          <option value="">Select Status</option>
          <option value="completed">‚úÖ Fixed 100% / –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ</option>
          <option value="waiting">‚è≥ Waiting for Part / –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏</option>
          <option value="temporary">üîß Temporary Fix / –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ</option>
          <option value="unrepairable">‚ùå Not Repairable / –ù–µ –ø–æ–¥–ª–µ–∂–∏—Ç —Ä–µ–º–æ–Ω—Ç—É</option>
        </select>
      </div>
      <div class="form-group">
        <label class="label">Additional Notes <span class="translation">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏</span></label>
        <textarea id="notes" placeholder="Enter any additional details or recommendations..."></textarea>
      </div>
      <div class="form-group input-dollar">
        <span class="dollar-sign" aria-label="Dollar">$</span>
        <input type="number" id="price" placeholder="0" min="0" step="1" inputmode="numeric"/>
      </div>
    </div>
    <div class="action-buttons">
      <button type="submit" class="btn btn-primary">üìã Generate Report</button>
      <button type="button" class="btn btn-secondary" id="clearBtn">üóëÔ∏è Clear Form</button>
    </div>
  </form>
  <div id="reportOutput" class="report-output hidden"><div class="report-title">üìÑ Service Report</div>
    <div id="reportContent" class="report-content"></div>
  </div>
  <div class="templates">
    <div class="templates-title">üí¨ Customer Message Templates</div>
    <button class="template-btn" data-template="completion">
      <div class="template-main">‚úÖ Service completed successfully - Your appliance is working perfectly</div>
      <div class="template-translation">‚úÖ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ - –í–∞—à–∞ —Ç–µ—Ö–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ</div>
    </button>
    <button class="template-btn" data-template="parts">
      <div class="template-main">üîß Part ordered - We'll return within 3-5 business days to complete the repair</div>
      <div class="template-translation">üîß –ó–∞–ø—á–∞—Å—Ç—å –∑–∞–∫–∞–∑–∞–Ω–∞ - –í–µ—Ä–Ω–µ–º—Å—è —á–µ—Ä–µ–∑ 3-5 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–º–æ–Ω—Ç–∞</div>
    </button>
    <button class="template-btn" data-template="estimate">
      <div class="template-main">üí∞ Repair estimate provided - Please review and let us know your decision</div>
      <div class="template-translation">üí∞ –°–º–µ—Ç–∞ —Ä–µ–º–æ–Ω—Ç–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ - –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏ —Å–æ–æ–±—â–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ</div>
    </button>
    <button class="template-btn" data-template="warranty">
      <div class="template-main">üõ°Ô∏è Repair covered under warranty - No charge for today's service</div>
      <div class="template-translation">üõ°Ô∏è –†–µ–º–æ–Ω—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏–µ–π - –°–µ–≥–æ–¥–Ω—è—à–Ω–µ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
    </button>
  </div>
  <div id="allReportsBlock"></div>
  <div id="reportsControlBtns" class="action-buttons" style="display:none;">
    <button type="button" class="btn btn-primary" id="copyAllBtn">üìë Copy All Reports</button>
    <button type="button" class="btn btn-primary" id="copyLastBtn">üìã Copy Last Report</button>
    <button type="button" class="btn btn-secondary" id="clearAllBtn">üóëÔ∏è Clear All Reports</button>
  </div>
</div>
<script>
// –î–õ–Ø –ü–†–ò–ú–ï–†–ê - —Ç–æ–ª—å–∫–æ –ø–æ 4 –∑–Ω–∞—á–µ–Ω–∏—è. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –≤—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–∏ –±–æ–ª—å—à–∏–µ –º–∞—Å—Å–∏–≤—ã!
const applianceData = {
refrigerator:{
brands:["LG","Samsung","Whirlpool","GE"],
problems:[{en:"Not cooling",ru:"–ù–µ –æ—Ö–ª–∞–∂–¥–∞–µ—Ç"},{en:"Leaking water",ru:"–¢–µ—á–µ—Ç –≤–æ–¥–∞"},{en:"Frost in freezer",ru:"–ò–Ω–µ–π –≤ –º–æ—Ä–æ–∑–∏–ª—å–Ω–∏–∫–µ"},{en:"Noisy operation",ru:"–°–∏–ª—å–Ω—ã–π —à—É–º"}],
diagnosis:[{en:"Compressor faulty",ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä"},{en:"Thermostat replaced",ru:"–¢–µ—Ä–º–æ—Å—Ç–∞—Ç –∑–∞–º–µ–Ω—ë–Ω"},{en:"Start relay bad",ru:"–ü—É—Å–∫–æ–≤–æ–µ —Ä–µ–ª–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ"},{en:"Defrost timer fault",ru:"–¢–∞–π–º–µ—Ä –æ—Ç—Ç–∞–π–∫–∏ –≤—ã—à–µ–ª –∏–∑ —Å—Ç—Ä–æ—è"}],
actions:[{en:"Replaced compressor",ru:"–ó–∞–º–µ–Ω–µ–Ω –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä"},{en:"Replaced thermostat",ru:"–ó–∞–º–µ–Ω—ë–Ω —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç"},{en:"Cleared drain",ru:"–ü–æ—á–∏—â–µ–Ω –¥—Ä–µ–Ω–∞–∂"},{en:"Installed new fan",ru:"–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–æ–≤—ã–π –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä"}]
},
dishwasher:{brands:["Bosch","Siemens","Indesit","Candy"],problems:[{en:"Not draining",ru:"–ù–µ —Å–ª–∏–≤–∞–µ—Ç –≤–æ–¥—É"},{en:"Not cleaning",ru:"–ü–ª–æ—Ö–æ –º–æ–µ—Ç –ø–æ—Å—É–¥—É"},{en:"Leaking",ru:"–ü—Ä–æ—Ç–µ–∫–∞–µ—Ç"},{en:"No power",ru:"–ù–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è"}],
diagnosis:[{en:"Pump blocked",ru:"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞—Å–æ—Å"},{en:"Heater fault",ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å"},{en:"Control board issue",ru:"–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–ª–∞—Ç–æ–π"},{en:"Faulty sensor",ru:"–°–ª–æ–º–∞–Ω –¥–∞—Ç—á–∏–∫"}],
actions:[{en:"Cleared debris",ru:"–£–¥–∞–ª—ë–Ω –º—É—Å–æ—Ä"},{en:"Replaced heater",ru:"–ü–æ–º–µ–Ω—è–Ω –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å"},{en:"Reset board",ru:"–ü–ª–∞—Ç–∞ —Å–±—Ä–æ—à–µ–Ω–∞"},{en:"Cleaned filter",ru:"–ü–æ—á–∏—â–µ–Ω —Ñ–∏–ª—å—Ç—Ä"}]},
washing_machine:{brands:["LG","Bosch","Whirlpool","Samsung"],problems:[{en:"Not spinning",ru:"–ù–µ –∫—Ä—É—Ç–∏—Ç –±–∞—Ä–∞–±–∞–Ω"},{en:"Water not draining",ru:"–ù–µ —Å–ª–∏–≤–∞–µ—Ç –≤–æ–¥—É"},{en:"Door locked",ru:"–î–≤–µ—Ä—Ü–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞"},{en:"Leakage",ru:"–ü—Ä–æ—Ç–µ–∫–∞–µ—Ç"}],
diagnosis:[{en:"Motor brushes worn",ru:"–©—ë—Ç–∫–∏ –º–æ—Ç–æ—Ä–∞ –∏–∑–Ω–æ—à–µ–Ω—ã"},{en:"Drain pump fault",ru:"–ù–µ–∏—Å–ø—Ä–∞–≤–µ–Ω –Ω–∞—Å–æ—Å"},{en:"Lock broken",ru:"–°–ª–æ–º–∞–Ω –∑–∞–º–æ–∫"},{en:"Hose leak",ru:"–¢–µ—á—å —à–ª–∞–Ω–≥–∞"}],
actions:[{en:"Changed brushes",ru:"–ü–æ–º–µ–Ω—è–Ω—ã —â—ë—Ç–∫–∏"},{en:"Cleaned drain",ru:"–ü–æ—á–∏—â–µ–Ω —Å–ª–∏–≤"},{en:"Repaired lock",ru:"–ó–∞–º–æ–∫ –æ—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω"},{en:"Replaced hose",ru:"–®–ª–∞–Ω–≥ –∑–∞–º–µ–Ω—ë–Ω"}]},
dryer:{brands:["Electrolux","Whirlpool","Bosch","Beko"],problems:[{en:"No heat",ru:"–ù–µ—Ç –Ω–∞–≥—Ä–µ–≤–∞"},{en:"Long dry time",ru:"–î–æ–ª–≥–æ —Å—É—à–∏—Ç"},{en:"Drum not spinning",ru:"–ë–∞—Ä–∞–±–∞–Ω –Ω–µ –∫—Ä—É—Ç–∏—Ç—Å—è"},{en:"Vibration",ru:"–í–∏–±—Ä–∏—Ä—É–µ—Ç"}],
diagnosis:[{en:"Heater dead",ru:"–ù–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å —Å–≥–æ—Ä–µ–ª"},{en:"Vent blocked",ru:"–ó–∞—Å–æ—Ä—ë–Ω –≤–æ–∑–¥—É—Ö–æ–≤–æ–¥"},{en:"Motor jammed",ru:"–î–≤–∏–≥–∞—Ç–µ–ª—å –∑–∞–∫–ª–∏–Ω–∏–ª–æ"},{en:"Faulty belt",ru:"–ü–æ—Ä–≤–∞–Ω —Ä–µ–º–µ–Ω—å"}],
actions:[{en:"Cleaned vent",ru:"–ü–æ—á–∏—â–µ–Ω –≤–æ–∑–¥—É—Ö–æ–≤–æ–¥"},{en:"Replaced heater",ru:"–ü–æ–º–µ–Ω—è–Ω –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å"},{en:"Changed belt",ru:"–ü–æ–º–µ–Ω—è–Ω —Ä–µ–º–µ–Ω—å"},{en:"Fixed motor",ru:"–ú–æ—Ç–æ—Ä –ø–æ—á–∏–Ω–µ–Ω"}]},
stove_oven:{brands:["Ariston","GE","Bosch","Gorenje"],problems:[{en:"Not heating",ru:"–ù–µ –≥—Ä–µ–µ—Ç"},{en:"No ignition",ru:"–ù–µ—Ç –∏—Å–∫—Ä—ã"},{en:"Uneven baking",ru:"–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–µ—á—ë—Ç"},{en:"Display dead",ru:"–î–∏—Å–ø–ª–µ–π –Ω–µ –≥–æ—Ä–∏—Ç"}],
diagnosis:[{en:"Element burnt",ru:"–¢—ç–Ω —Å–≥–æ—Ä–µ–ª"},{en:"Igniter broken",ru:"–ò—Å–∫—Ä–æ–≤–æ–π –º–æ–¥—É–ª—å —Å–ª–æ–º–∞–Ω"},{en:"Sensor bad",ru:"–î–∞—Ç—á–∏–∫ –Ω–µ–∏—Å–ø—Ä–∞–≤–µ–Ω"},{en:"Board fail",ru:"–ü–ª–∞—Ç–∞ –≤—ã—à–ª–∞ –∏–∑ —Å—Ç—Ä–æ—è"}],
actions:[{en:"Changed element",ru:"–ó–∞–º–µ–Ω—ë–Ω —Ç—ç–Ω"},{en:"Fixed igniter",ru:"–ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ä–æ–∑–∂–∏–≥"},{en:"Replaced sensor",ru:"–î–∞—Ç—á–∏–∫ –∑–∞–º–µ–Ω—ë–Ω"},{en:"Repaired board",ru:"–ü–æ—á–∏–Ω–µ–Ω–∞ –ø–ª–∞—Ç–∞"}]},
microwave:{brands:["Samsung","Panasonic","Whirlpool","Sharp"],problems:[{en:"No heating",ru:"–ù–µ –≥—Ä–µ–µ—Ç"},{en:"Plate not spinning",ru:"–¢–∞—Ä–µ–ª–∫–∞ –Ω–µ –∫—Ä—É—Ç–∏—Ç—Å—è"},{en:"Sparking",ru:"–ò—Å–∫—Ä–∏—Ç"},{en:"Noise",ru:"–ì—É–¥–∏—Ç"}],
diagnosis:[{en:"Magnetron dead",ru:"–ú–∞–≥–Ω–µ—Ç—Ä–æ–Ω —Å–≥–æ—Ä–µ–ª"},{en:"Turntable motor bad",ru:"–î–≤–∏–≥–∞—Ç–µ–ª—å —Ç–∞—Ä–µ–ª–∫–∏ —Å–ª–æ–º–∞–Ω"},{en:"Waveguide cover bad",ru:"–ú–∏–∫–∞ —Å–≥–æ—Ä–µ–ª–∞"},{en:"Fuse blown",ru:"–ü—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å –ø–µ—Ä–µ–≥–æ—Ä–µ–ª"}],
actions:[{en:"Changed magnetron",ru:"–ó–∞–º–µ–Ω—ë–Ω –º–∞–≥–Ω–µ—Ç—Ä–æ–Ω"},{en:"Fixed motor",ru:"–ú–æ—Ç–æ—Ä –ø–æ—á–∏–Ω–µ–Ω"},{en:"Replaced fuse",ru:"–ü–æ–º–µ–Ω—è–Ω –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å"},{en:"Cleaned cover",ru:"–ü–æ—á–∏—â–µ–Ω–∞ –º–∏–∫–∞"}]}
};

let customOptions = JSON.parse(localStorage.getItem('arpro_custom_options')||'{}');
const categorySelect = document.getElementById('category');
const brandSelect = document.getElementById('brand');
const problemSelect = document.getElementById('problem');
const diagnosisSelect = document.getElementById('diagnosis');
const actionSelect = document.getElementById('action');
const form = document.getElementById('repairForm');
const clearBtn = document.getElementById('clearBtn');

// –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
function promptAddCustom(where) {
  let cat = categorySelect.value;
  if (!cat) return alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–µ—Ö–Ω–∏–∫–∏!');
  let en = prompt('Custom option (EN):');
  if(!en) return;
  let ru = prompt('Custom option (RU, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):')||'';
  if (!customOptions[cat]) customOptions[cat] = {problem:[],diagnosis:[],action:[]};
  customOptions[cat][where].push({en,ru});
  localStorage.setItem('arpro_custom_options', JSON.stringify(customOptions));
  updateAllCategoryFields();
  updateDelBtns();
}

function reloadSelect(select, arr, field, cat){
  select.innerHTML = `<option value="">Select ${field.charAt(0).toUpperCase()+field.slice(1)}</option>`;
  arr.forEach(obj=>{
    select.insertAdjacentHTML('beforeend', `<option>${obj.en} / ${obj.ru}</option>`);
  });
  const customs = customOptions[cat]?.[field]||[];
  customs.forEach(({en,ru},i)=>{
    select.insertAdjacentHTML('beforeend', `<option data-custom="1" data-idx="${i}">${en}${ru?' / '+ru:''} ‚òÖ</option>`);
  });
}

function updateAllCategoryFields(){
  const c = categorySelect.value;
  if(!c || !applianceData[c]) {
      brandSelect.innerHTML='<option value="">Select Brand</option>';
      ['problem','diagnosis','action'].forEach(field=>{
         reloadSelect(document.getElementById(field),[],field,c);
      });
      return;
  }
  brandSelect.innerHTML='<option value="">Select Brand</option>';
  applianceData[c].brands.forEach(br=>{
    let op=document.createElement('option');
    op.value=br;
    op.textContent=br;
    brandSelect.appendChild(op);
  });
  ['problem','diagnosis','action'].forEach(field=>{
    reloadSelect(document.getElementById(field),applianceData[c][field+'s'],field,c);
  });
  updateDelBtns();
}

// –î–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å–≤–æ–∏—Ö –ø—É–Ω–∫—Ç–æ–≤
const delProblemBtn = document.getElementById('delCustomProblem');
const delDiagnosisBtn = document.getElementById('delCustomDiagnosis');
const delActionBtn = document.getElementById('delCustomAction');

function updateDelBtns() {
  const category = categorySelect.value;
  // Problem
  let sel = problemSelect;
  let opt = sel.options[sel.selectedIndex];
  delProblemBtn.style.display = (opt && opt.dataset.custom) ? '' : 'none';
  delProblemBtn.dataset.idx = opt?.dataset.idx;
  // Diagnosis
  sel = diagnosisSelect;
  opt = sel.options[sel.selectedIndex];
  delDiagnosisBtn.style.display = (opt && opt.dataset.custom) ? '' : 'none';
  delDiagnosisBtn.dataset.idx = opt?.dataset.idx;
  // Action
  sel = actionSelect;
  opt = sel.options[sel.selectedIndex];
  delActionBtn.style.display = (opt && opt.dataset.custom) ? '' : 'none';
  delActionBtn.dataset.idx = opt?.dataset.idx;
}
['problem','diagnosis','action'].forEach(id=>{
  document.getElementById(id).addEventListener('change',updateDelBtns);
});
categorySelect.addEventListener('change',updateDelBtns);

delProblemBtn.onclick = function() {
  const idx = +this.dataset.idx;
  const cat = categorySelect.value;
  if (isNaN(idx) || !customOptions[cat]?.problem[idx]) return;
  if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?')) {
    customOptions[cat].problem.splice(idx,1);
    localStorage.setItem('arpro_custom_options', JSON.stringify(customOptions));
    updateAllCategoryFields();
    updateDelBtns();
  }
};
delDiagnosisBtn.onclick = function() {
  const idx = +this.dataset.idx;
  const cat = categorySelect.value;
  if (isNaN(idx) || !customOptions[cat]?.diagnosis[idx]) return;
  if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?')) {
    customOptions[cat].diagnosis.splice(idx,1);
    localStorage.setItem('arpro_custom_options', JSON.stringify(customOptions));
    updateAllCategoryFields();
    updateDelBtns();
  }
};
delActionBtn.onclick = function() {
  const idx = +this.dataset.idx;
  const cat = categorySelect.value;
  if (isNaN(idx) || !customOptions[cat]?.action[idx]) return;
  if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç?')) {
    customOptions[cat].action.splice(idx,1);
    localStorage.setItem('arpro_custom_options', JSON.stringify(customOptions));
    updateAllCategoryFields();
    updateDelBtns();
  }
};

// == REPORT: –ò—Å—Ç–æ—Ä–∏—è –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ ==
let reportsArr = JSON.parse(localStorage.getItem('arpro_reports_history')||'[]');
function getCurrentReport(){
    return {
        date:new Date().toLocaleString(),
        appliance: categorySelect.options[categorySelect.selectedIndex]?.text ?? '',
        brand: brandSelect.options[brandSelect.selectedIndex]?.text ?? '',
        model: document.getElementById('model').value.trim(),
        serial: document.getElementById('serial').value.trim(),
        year: document.getElementById('year').value.trim(),
        month: document.getElementById('month_year').value.trim(),
        problem: problemSelect.options[problemSelect.selectedIndex]?.text ?? '',
        diagnosis: diagnosisSelect.options[diagnosisSelect.selectedIndex]?.text ?? '',
        action: actionSelect.options[actionSelect.selectedIndex]?.text ?? '',
        status: document.getElementById('status').options[document.getElementById('status').selectedIndex]?.text ?? '',
        notes: document.getElementById('notes').value.trim(),
        price: document.getElementById('price').value.trim()
    };
}
function reportToText(r){
    return `[${r.appliance}]
Brand: ${r.brand}
Model: ${r.model}
Serial#: ${r.serial}
Month: ${r.month}
Year: ${r.year}
Problem: ${r.problem}
Diagnosis: ${r.diagnosis}
Action: ${r.action}
Status: ${r.status}
Notes: ${r.notes}
Price: $${r.price}
Date: ${r.date}`.trim();
}
function renderAllReports(){
    let out = '';
    reportsArr.forEach((r,idx) => out+=`
        <div class="report-output" style="margin-top:24px;">
          <div class="report-title">üìÑ Report #${idx+1}</div>
          <div class="report-content">
             <div class="report-line"><span class="report-label">Date:</span> <span class="report-value">${r.date||''}</span></div>
             <div class="report-line"><span class="report-label">Appliance Type:</span> <span class="report-value">${r.appliance}</span></div>
             <div class="report-line"><span class="report-label">Brand:</span> <span class="report-value">${r.brand}</span></div>
             <div class="report-line"><span class="report-label">Model:</span> <span class="report-value">${r.model}</span></div>
             <div class="report-line"><span class="report-label">Serial:</span> <span class="report-value">${r.serial}</span></div>
             <div class="report-line"><span class="report-label">Month/Year:</span> <span class="report-value">${r.month}</span></div>
             <div class="report-line"><span class="report-label">Year of Manufacture:</span> <span class="report-value">${r.year}</span></div>
             <div class="report-line"><span class="report-label">Problem:</span> <span class="report-value">${r.problem}</span></div>
             <div class="report-line"><span class="report-label">Diagnosis:</span> <span class="report-value">${r.diagnosis}</span></div>
             <div class="report-line"><span class="report-label">Action Taken:</span> <span class="report-value">${r.action}</span></div>
             <div class="report-line"><span class="report-label">Status:</span> <span class="report-value">${r.status}</span></div>
             <div class="report-line"><span class="report-label">Additional Notes:</span> <span class="report-value">${r.notes}</span></div>
             <div class="report-line"><span class="report-label">Price:</span> <span class="report-value">$${r.price}</span></div>
          </div>
        </div>`);
    document.getElementById('allReportsBlock').innerHTML = out;
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∞–º–∏
    const btns = document.getElementById('reportsControlBtns');
    btns.style.display = reportsArr.length ? "" : "none";
}
categorySelect.addEventListener('change',updateAllCategoryFields);
form.addEventListener('submit', e => {
    e.preventDefault();
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –º–µ—Å—è—Ü–∞
    let v = document.getElementById('month_year').value.trim();
    if(v && !/^((0[1-9])|(1[0-2]))\.20[0-9]{2}$/.test(v)){
        alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –º–µ—Å—è—Ü–∞! –ü—Ä–∏–º–µ—Ä: 02.2025 –∏–ª–∏ 11.2023'); return;
    }
    const report = getCurrentReport();
    reportsArr.push(report);
    localStorage.setItem('arpro_reports_history', JSON.stringify(reportsArr));
    renderAllReports();
    form.reset(); updateAllCategoryFields();
    updateDelBtns();
});
clearBtn.addEventListener('click', () => {form.reset();updateAllCategoryFields(); updateDelBtns();});
window.addEventListener('DOMContentLoaded',()=>{
    renderAllReports();
    updateAllCategoryFields();
    updateDelBtns();
    document.querySelectorAll('.translation').forEach(el=>el.classList.remove('hidden'));
});
const modeButtons = document.querySelectorAll('.mode-btn');
modeButtons.forEach(button => {
    button.addEventListener('click', () => {
        modeButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        const isClient = button.getAttribute('data-mode') === 'client';
        document.querySelectorAll('.translation').forEach(el=>{
            if(isClient) el.classList.add('hidden'); else el.classList.remove('hidden');
        });
    });
});
document.getElementById('copyAllBtn').onclick = () => {
    if(reportsArr.length) navigator.clipboard.writeText(reportsArr.map(reportToText).join('\n\n====\n\n'));
};
document.getElementById('copyLastBtn').onclick = () => {
    if(reportsArr.length) navigator.clipboard.writeText(reportToText(reportsArr[reportsArr.length-1]));
};
document.getElementById('clearAllBtn').onclick = () => {
    if(confirm('Clear ALL reports?')){
        reportsArr.length = 0; renderAllReports(); localStorage.setItem('arpro_reports_history','[]');
    }
};
</script>
</body>
</html>
